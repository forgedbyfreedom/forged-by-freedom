on: [push, pull_request]
jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.x"

      - name: Debug workspace and find script
        run: |
          echo "GITHUB_WORKSPACE=$GITHUB_WORKSPACE"
          pwd
          ls -la "$GITHUB_WORKSPACE"
          echo "Searching for find_nonascii.py under the workspace..."
          SCRIPT=$(find "$GITHUB_WORKSPACE" -type f -name 'find_nonascii.py' -print -quit || true)
          if [ -n "$SCRIPT" ]; then
            echo "Found script at: $SCRIPT"
            echo "Running $SCRIPT"
            python3 "$SCRIPT"
          else
            echo "Script not found under $GITHUB_WORKSPACE"
            echo "Listing top-level directories:"
            ls -la "$GITHUB_WORKSPACE" || true
            echo "Attempting to list any 'scripts' directories under workspace:"
            find "$GITHUB_WORKSPACE" -maxdepth 3 -type d -name 'scripts' -exec ls -la {} \; || true
            exit 2
          fi

 or index changes detected."
            exit 0
          fi
          git commit -m "Auto update transcripts + file_index.json [skip ci]" || true
          git push https://${GH_USER}:${GH_PAT}@github.com/${GH_USER}/forged-by-freedom.git main || true

      # --------------------------------------
      # STEP 5: Sync updates to dashboard repo
      # --------------------------------------
      - name: üöÄ Sync transcripts + index to dashboard repo
        run: |
          echo "üì§ Syncing to dashboard repo..."
          git clone https://${GH_USER}:${GH_PAT}@github.com/${DASHBOARD_REPO}.git /tmp/dashboard
          mkdir -p /tmp/dashboard/transcripts
          cp transcripts/*/master_transcript*.txt /tmp/dashboard/transcripts/ 2>/dev/null || true
          cp transcripts/file_index.json /tmp/dashboard/transcripts/ || true
          cd /tmp/dashboard
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add transcripts/
          if git diff --cached --quiet; then
            echo "‚ÑπÔ∏è No dashboard updates detected."
            exit 0
          fi
          git commit -m "Sync transcripts + file index [skip ci]" || true
          git push https://${GH_USER}:${GH_PAT}@github.com/${DASHBOARD_REPO}.git main || true

      # --------------------------------------
      # STEP 6: Update OpenAI Assistant + cleanup
      # --------------------------------------
      - name: üßπ Update OpenAI Assistant and remove old files
        run: |
          python3 <<'PYCODE'
          import os, json
          from openai import OpenAI

          key = os.getenv("OPENAI_API_KEY")
          asst_id = os.getenv("ASSISTANT_ID")
          if not key or not asst_id:
              print("‚ö†Ô∏è Missing OpenAI credentials or Assistant ID.")
              raise SystemExit(0)

          client = OpenAI(api_key=key)
          if not os.path.exists("transcripts/file_index.json"):
              print("‚ö†Ô∏è file_index.json not found ‚Äî skipping assistant update.")
              raise SystemExit(0)

          with open("transcripts/file_index.json", "r") as f:
              file_index = json.load(f)

          new_file_ids = [f.get("file_id") for f in file_index if f.get("file_id")]
          print(f"üîó Linking {len(new_file_ids)} files to assistant {asst_id}...")
          client.beta.assistants.update(asst_id, file_ids=new_file_ids)
          print("‚úÖ Assistant successfully updated.")

          all_files = client.files.list().data
          keep = set(new_file_ids)
          removed = 0
          for f in all_files:
              if f.id not in keep and f.filename.endswith("master_transcript1.txt"):
                  try:
                      client.files.delete(f.id)
                      removed += 1
                  except Exception as e:
                      print(f
